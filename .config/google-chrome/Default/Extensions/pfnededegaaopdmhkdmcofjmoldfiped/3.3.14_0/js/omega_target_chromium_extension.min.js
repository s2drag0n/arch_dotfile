!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).OmegaTargetChromium=f()}}((function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){module.exports=require("./lib/heap")},{"./lib/heap":2}],2:[function(require,module,exports){(function(){var Heap,defaultCmp,floor,heapify,heappop,heappush,heappushpop,heapreplace,insort,min,nlargest,nsmallest,updateItem,_siftdown,_siftup,root,factory;floor=Math.floor,min=Math.min,defaultCmp=function(x,y){return x<y?-1:x>y?1:0},insort=function(a,x,lo,hi,cmp){var mid;if(null==lo&&(lo=0),null==cmp&&(cmp=defaultCmp),lo<0)throw new Error("lo must be non-negative");for(null==hi&&(hi=a.length);lo<hi;)cmp(x,a[mid=floor((lo+hi)/2)])<0?hi=mid:lo=mid+1;return[].splice.apply(a,[lo,lo-lo].concat(x)),x},heappush=function(array,item,cmp){return null==cmp&&(cmp=defaultCmp),array.push(item),_siftdown(array,0,array.length-1,cmp)},heappop=function(array,cmp){var lastelt,returnitem;return null==cmp&&(cmp=defaultCmp),lastelt=array.pop(),array.length?(returnitem=array[0],array[0]=lastelt,_siftup(array,0,cmp)):returnitem=lastelt,returnitem},heapreplace=function(array,item,cmp){var returnitem;return null==cmp&&(cmp=defaultCmp),returnitem=array[0],array[0]=item,_siftup(array,0,cmp),returnitem},heappushpop=function(array,item,cmp){var _ref;return null==cmp&&(cmp=defaultCmp),array.length&&cmp(array[0],item)<0&&(item=(_ref=[array[0],item])[0],array[0]=_ref[1],_siftup(array,0,cmp)),item},heapify=function(array,cmp){var i,_i,_len,_ref1,_results,_results1;for(null==cmp&&(cmp=defaultCmp),_ref1=function(){_results1=[];for(var _j=0,_ref=floor(array.length/2);0<=_ref?_j<_ref:_j>_ref;0<=_ref?_j++:_j--)_results1.push(_j);return _results1}.apply(this).reverse(),_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)i=_ref1[_i],_results.push(_siftup(array,i,cmp));return _results},updateItem=function(array,item,cmp){var pos;if(null==cmp&&(cmp=defaultCmp),-1!==(pos=array.indexOf(item)))return _siftdown(array,0,pos,cmp),_siftup(array,pos,cmp)},nlargest=function(array,n,cmp){var elem,result,_i,_len,_ref;if(null==cmp&&(cmp=defaultCmp),!(result=array.slice(0,n)).length)return result;for(heapify(result,cmp),_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)elem=_ref[_i],heappushpop(result,elem,cmp);return result.sort(cmp).reverse()},nsmallest=function(array,n,cmp){var elem,los,result,_i,_j,_len,_ref,_ref1,_results;if(null==cmp&&(cmp=defaultCmp),10*n<=array.length){if(!(result=array.slice(0,n).sort(cmp)).length)return result;for(los=result[result.length-1],_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)cmp(elem=_ref[_i],los)<0&&(insort(result,elem,0,null,cmp),result.pop(),los=result[result.length-1]);return result}for(heapify(array,cmp),_results=[],_j=0,_ref1=min(n,array.length);0<=_ref1?_j<_ref1:_j>_ref1;0<=_ref1?++_j:--_j)_results.push(heappop(array,cmp));return _results},_siftdown=function(array,startpos,pos,cmp){var newitem,parent,parentpos;for(null==cmp&&(cmp=defaultCmp),newitem=array[pos];pos>startpos&&cmp(newitem,parent=array[parentpos=pos-1>>1])<0;)array[pos]=parent,pos=parentpos;return array[pos]=newitem},_siftup=function(array,pos,cmp){var childpos,endpos,newitem,rightpos,startpos;for(null==cmp&&(cmp=defaultCmp),endpos=array.length,startpos=pos,newitem=array[pos],childpos=2*pos+1;childpos<endpos;)(rightpos=childpos+1)<endpos&&!(cmp(array[childpos],array[rightpos])<0)&&(childpos=rightpos),array[pos]=array[childpos],childpos=2*(pos=childpos)+1;return array[pos]=newitem,_siftdown(array,startpos,pos,cmp)},Heap=function(){function Heap(cmp){this.cmp=null!=cmp?cmp:defaultCmp,this.nodes=[]}return Heap.push=heappush,Heap.pop=heappop,Heap.replace=heapreplace,Heap.pushpop=heappushpop,Heap.heapify=heapify,Heap.updateItem=updateItem,Heap.nlargest=nlargest,Heap.nsmallest=nsmallest,Heap.prototype.push=function(x){return heappush(this.nodes,x,this.cmp)},Heap.prototype.pop=function(){return heappop(this.nodes,this.cmp)},Heap.prototype.peek=function(){return this.nodes[0]},Heap.prototype.contains=function(x){return-1!==this.nodes.indexOf(x)},Heap.prototype.replace=function(x){return heapreplace(this.nodes,x,this.cmp)},Heap.prototype.pushpop=function(x){return heappushpop(this.nodes,x,this.cmp)},Heap.prototype.heapify=function(){return heapify(this.nodes,this.cmp)},Heap.prototype.updateItem=function(x){return updateItem(this.nodes,x,this.cmp)},Heap.prototype.clear=function(){return this.nodes=[]},Heap.prototype.empty=function(){return 0===this.nodes.length},Heap.prototype.size=function(){return this.nodes.length},Heap.prototype.clone=function(){var heap;return(heap=new Heap).nodes=this.nodes.slice(0),heap},Heap.prototype.toArray=function(){return this.nodes.slice(0)},Heap.prototype.insert=Heap.prototype.push,Heap.prototype.top=Heap.prototype.peek,Heap.prototype.front=Heap.prototype.peek,Heap.prototype.has=Heap.prototype.contains,Heap.prototype.copy=Heap.prototype.clone,Heap}(),root=this,factory=function(){return Heap},"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?module.exports=factory():root.Heap=factory()}).call(this)},{}],3:[function(require,module,exports){(function(global){!function(root){var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule="object"==typeof module&&module&&!module.nodeType&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var punycode,key,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return parts.length>1&&(result=parts[0]+"@",string=parts[1]),result+map((string=string.replace(regexSeparators,".")).split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)(value=string.charCodeAt(counter++))>=55296&&value<=56319&&counter<length?56320==(64512&(extra=string.charCodeAt(counter++)))?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--):output.push(value);return output}function ucs2encode(array){return map(array,(function(value){var output="";return value>65535&&(output+=stringFromCharCode((value-=65536)>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)})).join("")}function basicToDigit(codePoint){return codePoint-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/damp):delta>>1,delta+=floor(delta/numPoints);delta>baseMinusTMin*tMax>>1;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,output=[],inputLength=input.length,i=0,n=initialN,bias=initialBias;for((basic=input.lastIndexOf(delimiter))<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;index>=inputLength&&error("invalid-input"),((digit=basicToDigit(input.charCodeAt(index++)))>=base||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,!(digit<(t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias));k+=base)w>floor(maxInt/(baseMinusT=base-t))&&error("overflow"),w*=baseMinusT;bias=adapt(i-oldi,out=output.length+1,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(inputLength=(input=ucs2decode(input)).length,n=initialN,delta=0,bias=initialBias,j=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push(delimiter);handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)(currentValue=input[j])>=n&&currentValue<m&&(m=currentValue);for(m-n>floor((maxInt-delta)/(handledCPCountPlusOne=handledCPCount+1))&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if((currentValue=input[j])<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=base;!(q<(t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias));k+=base)qMinusT=q-t,baseMinusT=base-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}function toUnicode(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}function toASCII(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))}if(punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",(function(){return punycode}));else if(freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],5:[function(require,module,exports){"use strict";var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),(function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))})).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))})).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)};function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],6:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode")},{"./decode":4,"./encode":5}],7:[function(require,module,exports){var punycode=require("punycode");function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,unwise=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}function urlFormat(obj){return isString(obj)&&(obj=urlParse(obj)),obj instanceof Url?obj.format():Url.prototype.format.call(obj)}function urlResolve(source,relative){return urlParse(source,!1,!0).resolve(relative)}function urlResolveObject(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative}function isString(arg){return"string"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var rest=url;rest=rest.trim();var proto=protocolPattern.exec(rest);if(proto){var lowerProto=(proto=proto[0]).toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var auth,atSign,hostEnd=-1,i=0;i<hostEndingChars.length;i++){-1!==(hec=rest.indexOf(hostEndingChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1!==(atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd))&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(i=0;i<nonHostChars.length;i++){var hec;-1!==(hec=rest.indexOf(nonHostChars[i]))&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),l=(i=0,hostparts.length);i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}if(this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),!ipv6Hostname){var domainArray=this.hostname.split("."),newOut=[];for(i=0;i<domainArray.length;++i){var s=domainArray[i];newOut.push(s.match(/[^A-Za-z0-9_-]/)?"xn--"+punycode.encode(s):s)}this.hostname=newOut.join(".")}var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i],esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){p=this.pathname||"",s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=(auth=encodeURIComponent(auth)).replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),protocol+host+(pathname=pathname.replace(/[?#]/g,(function(match){return encodeURIComponent(match)})))+(search=search.replace("#","%23"))+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}var result=new Url;if(Object.keys(this).forEach((function(k){result[k]=this[k]}),this),result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol)return Object.keys(relative).forEach((function(k){"protocol"!==k&&(result[k]=relative[k])})),slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result;if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol])return Object.keys(relative).forEach((function(k){result[k]=relative[k]})),result.href=result.format(),result;if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],psychotic=(relPath=relative.pathname&&relative.pathname.split("/")||[],result.protocol&&!slashedProtocol[result.protocol]);if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!isNullOrUndefined(relative.search)){if(psychotic)result.hostname=result.host=srcPath.shift(),(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift());return result.search=relative.search,result.query=relative.query,isNull(result.pathname)&&isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)"."==(last=srcPath[i])?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var authInHost,isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);psychotic&&(result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"",(authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@"))&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift()));return(mustEndAbs=mustEndAbs||result.host&&srcPath.length)&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),isNull(result.pathname)&&isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(":"!==(port=port[0])&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},{punycode:3,querystring:6}],8:[function(require,module,exports){module.exports=OmegaTarget},{}],9:[function(require,module,exports){var OmegaTarget,Promise,slice=[].slice;OmegaTarget=require("omega-target"),Promise=OmegaTarget.Promise,exports.chromeApiPromisify=function(target,method){return function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],new Promise((function(resolve,reject){var callback;return callback=function(){var callbackArgs,error;return callbackArgs=1<=arguments.length?slice.call(arguments,0):[],null!=chrome.runtime.lastError?((error=new Error(chrome.runtime.lastError.message)).original=chrome.runtime.lastError,reject(error)):callbackArgs.length<=1?resolve(callbackArgs[0]):resolve(callbackArgs)},args.push(callback),target[method].apply(target,args)}))}}},{"omega-target":8}],10:[function(require,module,exports){var TrackedEvent,slice=[].slice;module.exports=function(){function ChromePort(port){var _this;this.port=port,this.name=this.port.name,this.sender=this.port.sender,this.disconnect=this.port.disconnect.bind(this.port),this.postMessage=(_this=this,function(){var args,ref;args=1<=arguments.length?slice.call(arguments,0):[];try{return(ref=_this.port).postMessage.apply(ref,args)}catch(error){}}),this.onMessage=new TrackedEvent(this.port.onMessage),this.onDisconnect=new TrackedEvent(this.port.onDisconnect),this.onDisconnect.addListener(this.dispose.bind(this))}return ChromePort.prototype.dispose=function(){return this.onMessage.dispose(),this.onDisconnect.dispose()},ChromePort}(),TrackedEvent=function(){function TrackedEvent(event){var j,len,mes,method,methodName;for(this.event=event,this.callbacks=[],j=0,len=(mes=["hasListener","hasListeners","addRules","getRules","removeRules"]).length;j<len;j++)methodName=mes[j],null!=(method=this.event[methodName])&&(this[methodName]=method.bind(this.event))}return TrackedEvent.prototype.addListener=function(callback){return this.event.addListener(callback),this.callbacks.push(callback),this},TrackedEvent.prototype.removeListener=function(callback){var i;return this.event.removeListener(callback),(i=this.callbacks.indexOf(callback))>=0&&this.callbacks.splice(i,1),this},TrackedEvent.prototype.removeAllListeners=function(){var callback,j,len,ref;for(j=0,len=(ref=this.callbacks).length;j<len;j++)callback=ref[j],this.event.removeListener(callback);return this.callbacks=[],this},TrackedEvent.prototype.dispose=function(){var base;if(this.removeAllListeners(),"function"==typeof(base=this.event).hasListeners?base.hasListeners():void 0)throw new Error("Underlying Event still has listeners!");return this.event=null,this.callbacks=null},TrackedEvent}()},{}],11:[function(require,module,exports){var ChromePort,OmegaTarget;(OmegaTarget=require("omega-target")).OmegaPac,OmegaTarget.Promise,ChromePort=require("./chrome_port"),module.exports=function(){function ExternalApi(options){this.options=options}return ExternalApi.prototype.knownExts={padekgcemlokbadohgkifijomclgjgif:32},ExternalApi.prototype.disabled=!1,ExternalApi.prototype.listen=function(){var _this;if(chrome.runtime.onConnectExternal)return chrome.runtime.onConnectExternal.addListener((_this=this,function(rawPort){var port;return(port=new ChromePort(rawPort)).onMessage.addListener((function(msg){return _this.onMessage(msg,port)})),port.onDisconnect.addListener(_this.reenable.bind(_this))}))},ExternalApi.prototype._previousProfileName=null,ExternalApi.prototype.reenable=function(){var base;if(this.disabled)return this.options.setProxyNotControllable(null),"function"==typeof(base=chrome.action).setPopup&&base.setPopup({popup:"popup-iframe.html"}),this.options.reloadQuickSwitch(),this.disabled=!1,this.options.clearBadge(),this.options.applyProfile(this._previousProfileName)},ExternalApi.prototype.checkPerm=function(port,level){return!((this.knownExts[port.sender.id]||0)<level)||(port.postMessage({action:"error",error:"permission"}),!1)},ExternalApi.prototype.onMessage=function(msg,port){var base,ref,_this;switch(this.options.log.log(port.sender.id+" -> "+msg.action,msg),msg.action){case"disable":if(!this.checkPerm(port,16))return;if(this.disabled)return;return this.disabled=!0,this._previousProfileName=(null!=(ref=this.options.currentProfile())?ref.name:void 0)||"system",this.options.applyProfile("system").then((_this=this,function(){var reason;return reason="disabled",_this.knownExts[port.sender.id]>=32&&(reason="upgrade"),_this.options.setProxyNotControllable(reason,{text:"X",color:"#5ab432"})})),"function"==typeof(base=chrome.action).setPopup&&base.setPopup({popup:"popup-iframe.html"}),port.postMessage({action:"state",state:"disabled"});case"enable":return this.reenable(),port.postMessage({action:"state",state:"enabled"});case"getOptions":if(!this.checkPerm(port,8))return;return port.postMessage({action:"options",options:this.options.getAll()});default:return port.postMessage({action:"error",error:"noSuchAction",action_name:msg.action})}},ExternalApi}()},{"./chrome_port":10,"omega-target":8}],12:[function(require,module,exports){var ContentTypeRejectedError,Url,defaultHintHandler,fetchUrl,hintHandlers,xhrWrapper,slice=[].slice;OmegaTarget.Promise,Url=require("url"),ContentTypeRejectedError=OmegaTarget.ContentTypeRejectedError,xhrWrapper=function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],fetch.apply(null,args).then((function(response){return response.text().then((function(body){return[response,body]}))})).catch((function(err){if(!err.isOperational)throw err;if(!err.statusCode)throw new OmegaTarget.NetworkError(err);if(404===err.statusCode)throw new OmegaTarget.HttpNotFoundError(err);if(err.statusCode>=500&&err.statusCode<600)throw new OmegaTarget.HttpServerError(err);throw new OmegaTarget.HttpError(err)}))},fetchUrl=function(dest_url,opt_bypass_cache,opt_type_hints){var dest_url_nocache,getResBody,parsed;return getResBody=function(arg){var body,contentType,hint,i,len,ref,ref1,response,result;if(response=arg[0],body=arg[1],!opt_type_hints)return body;for(contentType=null!=(ref=response.headers["content-type"])?ref.toLowerCase():void 0,i=0,len=opt_type_hints.length;i<len;i++)if(hint=opt_type_hints[i],null!=(result=(null!=(ref1=hintHandlers[hint])?ref1:defaultHintHandler)(response,body,{contentType:contentType,hint:hint})))return result;throw new ContentTypeRejectedError("Unrecognized Content-Type: "+contentType)},opt_bypass_cache&&dest_url.indexOf("?")<0?((parsed=Url.parse(dest_url,!0)).search=void 0,parsed.query._=Date.now(),dest_url_nocache=Url.format(parsed),xhrWrapper(dest_url_nocache).then(getResBody).catch((function(){return xhrWrapper(dest_url).then(getResBody)}))):xhrWrapper(dest_url).then(getResBody)},defaultHintHandler=function(response,body,arg){var contentType,hint;if("!"+(contentType=arg.contentType)===(hint=arg.hint))throw new ContentTypeRejectedError("Response Content-Type blacklisted: "+contentType);if(contentType===hint)return body},hintHandlers={"*":function(response,body){return body},"!text/html":function(response,body,arg){var looksLikeHtml;if(arg.contentType===arg.hint&&(looksLikeHtml=!1,(body.indexOf("<!DOCTYPE")>=0||body.indexOf("<!doctype")>=0||body.indexOf("</html>")>=0||body.indexOf("</body>")>=0)&&(looksLikeHtml=!0),looksLikeHtml))throw new ContentTypeRejectedError("Response must not be HTML.")},"!application/xhtml+xml":function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],hintHandlers["!text/html"].apply(hintHandlers,args)},"application/x-ns-proxy-autoconfig":function(response,body,arg){return arg.contentType===arg.hint||body.indexOf("FindProxyForURL")>=0?body:void 0}},module.exports=fetchUrl},{url:7}],13:[function(require,module,exports){var base,name,ref,value;for(name in module.exports={Storage:require("./storage"),SyncStorage:require("./sync_storage"),Options:require("./options"),ChromeTabs:require("./tabs"),SwitchySharp:require("./switchysharp"),ExternalApi:require("./external_api"),WebRequestMonitor:require("./web_request_monitor"),Inspect:require("./inspect"),Url:require("url"),proxy:require("./proxy")},ref=require("omega-target"))value=ref[name],null==(base=module.exports)[name]&&(base[name]=value)},{"./external_api":11,"./inspect":14,"./options":15,"./proxy":16,"./storage":22,"./switchysharp":23,"./sync_storage":24,"./tabs":25,"./web_request_monitor":26,"omega-target":8,url:7}],14:[function(require,module,exports){var OmegaTarget,hasProp={}.hasOwnProperty;(OmegaTarget=require("omega-target")).OmegaPac,OmegaTarget.Promise,module.exports=function(){function Inspect(onInspect){this.onInspect=onInspect}return Inspect.prototype._enabled=!1,Inspect.prototype.enable=function(){var webResource;if(null!=chrome.contextMenus&&null!=chrome.i18n.getUILanguage&&!this._enabled)return webResource=["http://*/*","https://*/*","ftp://*/*"],chrome.contextMenus.create({id:"inspectFrame",title:chrome.i18n.getMessage("contextMenu_inspectFrame"),contexts:["frame"],documentUrlPatterns:webResource}),chrome.contextMenus.create({id:"inspectLink",title:chrome.i18n.getMessage("contextMenu_inspectLink"),contexts:["link"],targetUrlPatterns:webResource}),chrome.contextMenus.create({id:"inspectElement",title:chrome.i18n.getMessage("contextMenu_inspectElement"),contexts:["image","video","audio"],targetUrlPatterns:webResource}),this._enabled=!0},Inspect.prototype.disable=function(){var menuId,ref;if(this._enabled){for(menuId in ref=this.propForMenuItem)if(hasProp.call(ref,menuId))try{chrome.contextMenus.remove(menuId)}catch(error){}return this._enabled=!1}},Inspect.prototype.propForMenuItem={inspectFrame:"frameUrl",inspectLink:"linkUrl",inspectElement:"srcUrl"},Inspect.prototype.inspect=function(info,tab){var url;if(info.menuItemId&&((url=info[this.propForMenuItem[info.menuItemId]])||"inspectPage"!==info.menuItemId||(url=tab.url),url))return this.onInspect(url,tab)},Inspect}()},{"omega-target":8}],15:[function(require,module,exports){var ChromeOptions,ChromePort,OmegaPac,OmegaTarget,Promise,TEMPPROFILEKEY,Url,WebRequestMonitor,fetchUrl,querystring,extend=function(child,parent){for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);function ctor(){this.constructor=child}return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,slice=[].slice;OmegaTarget=require("omega-target"),OmegaPac=OmegaTarget.OmegaPac,Promise=OmegaTarget.Promise,querystring=require("querystring"),WebRequestMonitor=require("./web_request_monitor"),ChromePort=require("./chrome_port"),fetchUrl=require("./fetch_url"),Url=require("url"),TEMPPROFILEKEY="tempProfileState",ChromeOptions=function(superClass){function ChromeOptions(){var args,ref,_this;args=1<=arguments.length?slice.call(arguments,0):[],ChromeOptions.__super__.constructor.apply(this,args),chrome.alarms.onAlarm.addListener((_this=this,function(alarm){if("omega.updateProfile"===alarm.name)return _this.ready.then((function(){return _this.updateProfile()}))})),null!=(ref=chrome.contextMenus)&&ref.onClicked.addListener(function(_this){return function(info,tab){return _this.ready.then((function(){var changes,setOptions;if("enableQuickSwitch"===info.menuItemId)if((changes={})["-enableQuickSwitch"]=info.checked,setOptions=_this._setOptions(changes),info.checked&&!_this._quickSwitchCanEnable)return setOptions.then((function(){return chrome.tabs.create({url:chrome.runtime.getURL("options.html#/ui")})}))}))}}(this)),chrome.action.onClicked.addListener(function(_this){return function(tab){var ref1;return null!=("undefined"!=typeof browser&&null!==browser&&null!=(ref1=browser.proxy)?ref1.onRequest:void 0)&&browser.permissions.request({origins:["<all_urls>"]}),_this.ready.then((function(){var index,profiles;if(_this.clearBadge(),_this._options["-enableQuickSwitch"])return index=((index=(profiles=_this._options["-quickSwitchProfiles"]).indexOf(_this._currentProfileName))+1)%profiles.length,_this.applyProfile(profiles[index]).then((function(){var url;if(_this._options["-refreshOnProfileChange"]){if(!(url=tab.pendingUrl||tab.url))return;if("chrome"===url.substr(0,6))return;if("about:"===url.substr(0,6))return;if("moz-"===url.substr(0,4))return;return tab.pendingUrl?chrome.tabs.update(tab.id,{url:url}):chrome.tabs.reload(tab.id)}}));chrome.tabs.create({url:"popup/index.html"})}))}}(this))}return extend(ChromeOptions,superClass),ChromeOptions.prototype._inspect=null,ChromeOptions.prototype.fetchUrl=fetchUrl,ChromeOptions.prototype.init=function(startupCheck){var _this;return ChromeOptions.__super__.init.call(this,startupCheck),this.ready.then((_this=this,function(){return chrome.storage.session.get(TEMPPROFILEKEY).then((function(tempProfileState){if(null==tempProfileState&&(tempProfileState={}),tempProfileState=globalThis.hasStartupCheck?tempProfileState[TEMPPROFILEKEY]:null)return _this._tempProfile=tempProfileState._tempProfile,_this._tempProfile.rules.forEach((function(_rule){var domain,key;return key=OmegaPac.Profiles.nameAsKey(_rule.profileName),_this._tempProfileRulesByProfile[key]=_this._tempProfileRulesByProfile[key]||[],_this._tempProfileRulesByProfile[key].push(_rule),domain=_rule.condition.pattern.substring(2),_this._tempProfileRules[domain]=_rule})),_this._tempProfileActive=tempProfileState._tempProfileActive,OmegaPac.Profiles.updateRevision(_this._tempProfile),console.log("apply temp state profile",_this._currentProfileName),_this.applyProfile(_this._currentProfileName)}))})),this.ready},ChromeOptions.prototype.addTempRule=function(domain,profileName){return ChromeOptions.__super__.addTempRule.call(this,domain,profileName).then((_this=this,function(){var _zeroState;return(_zeroState={})[TEMPPROFILEKEY]={_tempProfile:_this._tempProfile,_tempProfileActive:_this._tempProfileActive},chrome.storage.session.set(_zeroState)}));var _this},ChromeOptions.prototype.updateProfile=function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],ChromeOptions.__super__.updateProfile.apply(this,args).then((function(results){var profileName;for(profileName in!1,results)if(hasProp.call(results,profileName)&&results[profileName]instanceof Error){!0;break}return results}))},ChromeOptions.prototype._proxyNotControllable=null,ChromeOptions.prototype.proxyNotControllable=function(){return this._proxyNotControllable},ChromeOptions.prototype.setProxyNotControllable=function(reason,badge){return this._proxyNotControllable=reason,reason?(this._state.set({proxyNotControllable:reason}),this.setBadge(badge)):(this._state.remove(["proxyNotControllable"]),this.clearBadge())},ChromeOptions.prototype._badgeTitle=null,ChromeOptions.prototype.setBadge=function(options){return options||(options=this._proxyNotControllable?{text:"=",color:"#da4f49"}:{text:"?",color:"#49afcd"}),chrome.action.setBadgeText({text:options.text}),chrome.action.setBadgeBackgroundColor({color:options.color}),options.title?(this._badgeTitle=options.title,chrome.action.setTitle({title:options.title})):this._badgeTitle=null},ChromeOptions.prototype.clearBadge=function(){var base;this.externalApi.disabled||(this._badgeTitle&&this.currentProfileChanged("clearBadge"),this._proxyNotControllable?this.setBadge():"function"==typeof(base=chrome.action).setBadgeText&&base.setBadgeText({text:""}))},ChromeOptions.prototype._quickSwitchCanEnable=!1,ChromeOptions.prototype.setQuickSwitch=function(quickSwitch,canEnable){var ref;return this._quickSwitchCanEnable=canEnable,quickSwitch?chrome.action.setPopup({popup:""}):chrome.action.setPopup({popup:"popup-iframe.html"}),null!=(ref=chrome.contextMenus)&&ref.update("enableQuickSwitch",{checked:!!quickSwitch}),Promise.resolve()},ChromeOptions.prototype.setInspect=function(settings){return this._inspect&&(settings.showMenu?this._inspect.enable():this._inspect.disable()),Promise.resolve()},ChromeOptions.prototype._requestMonitor=null,ChromeOptions.prototype._monitorWebRequests=!1,ChromeOptions.prototype._tabRequestInfoPorts=null,ChromeOptions.prototype.setMonitorWebRequests=function(enabled){var wildcardForReq,_this;if(this._monitorWebRequests=enabled,enabled&&null==this._requestMonitor)return this._tabRequestInfoPorts={},wildcardForReq=function(req){return OmegaPac.wildcardForUrl(req.url)},this._requestMonitor=new WebRequestMonitor(wildcardForReq),this._requestMonitor.watchTabs((_this=this,function(tabId,info){var badge,ref;if(_this._monitorWebRequests)return info.errorCount>0?(info.badgeSet=!0,badge={text:info.errorCount.toString(),color:"#f0ad4e"},chrome.action.setBadgeText({text:badge.text,tabId:tabId}).catch((function(e){return console.log("error:",e)})),chrome.action.setBadgeBackgroundColor({color:badge.color,tabId:tabId}).catch((function(e){return console.log("error:",e)}))):info.badgeSet&&(info.badgeSet=!1,chrome.action.setBadgeText({text:"",tabId:tabId}).catch((function(e){return console.log("error:",e)}))),null!=(ref=_this._tabRequestInfoPorts[tabId])?ref.postMessage({errorCount:info.errorCount,summary:info.summary}):void 0})),chrome.runtime.onConnect.addListener(function(_this){return function(rawPort){var port,tabId;if("tabRequestInfo"===rawPort.name&&_this._monitorWebRequests)return tabId=null,(port=new ChromePort(rawPort)).onMessage.addListener((function(msg){var info;if(tabId=msg.tabId,_this._tabRequestInfoPorts[tabId]=port,info=_this._requestMonitor.tabInfo[tabId])return port.postMessage({errorCount:info.errorCount,summary:info.summary})})),port.onDisconnect.addListener((function(){if(null!=tabId)return delete _this._tabRequestInfoPorts[tabId]}))}}(this))},ChromeOptions.prototype.schedule=function(name,periodInMinutes){return name="omega."+name,periodInMinutes<0?chrome.alarms.clear(name):chrome.alarms.create(name,{periodInMinutes:periodInMinutes}),Promise.resolve()},ChromeOptions.prototype.printFixedProfile=function(profile){var i,len,pacResult,ref,result,scheme;if("FixedProfile"===profile.profileType){for(result="",i=0,len=(ref=OmegaPac.Profiles.schemes).length;i<len;i++)profile[(scheme=ref[i]).prop]&&(pacResult=OmegaPac.Profiles.pacResult(profile[scheme.prop]),scheme.scheme?result+=scheme.scheme+": "+pacResult+"\n":result+=pacResult+"\n");return result||(result=chrome.i18n.getMessage("browserAction_profileDetails_DirectProfile")),result}},ChromeOptions.prototype.printProfile=function(profile){var type;return(type=profile.profileType).indexOf("RuleListProfile")>=0&&(type="RuleListProfile"),"FixedProfile"===type?this.printFixedProfile(profile):"PacProfile"===type&&profile.pacUrl?profile.pacUrl:chrome.i18n.getMessage("browserAction_profileDetails_"+type)||null},ChromeOptions.prototype.upgrade=function(options,changes){return ChromeOptions.__super__.upgrade.call(this,options).catch((function(err){return Promise.reject(err)}))},ChromeOptions.prototype.onFirstRun=function(reason){return console.log("first run ...."),chrome.tabs.create({url:chrome.runtime.getURL("options.html")})},ChromeOptions.prototype.getPageInfo=function(arg){var errorCount,getBadge,getInspectUrl,ref,ref1,result,tabId,url,_this;return tabId=arg.tabId,url=arg.url,errorCount=null!=(ref=this._requestMonitor)&&null!=(ref1=ref.tabInfo[tabId])?ref1.errorCount:void 0,result=errorCount?{errorCount:errorCount}:null,getBadge=new Promise((function(resolve,reject){if(null!=chrome.action.getBadgeText)return chrome.action.getBadgeText({tabId:tabId},(function(result){return resolve(result)}));resolve("")})),getInspectUrl=this._state.get({inspectUrl:""}),Promise.join(getBadge,getInspectUrl,(_this=this,function(badge,arg1){var domain,errorPagePrefix,inspectUrl;if(inspectUrl=arg1.inspectUrl,"#"===badge&&inspectUrl?url=inspectUrl:_this.clearBadge(),!url)return result;if("chrome"===url.substr(0,6)){if(errorPagePrefix="chrome://errorpage/",url.substr(0,errorPagePrefix.length)!==errorPagePrefix)return result;if(!(url=querystring.parse(url.substr(url.indexOf("?")+1)).lasturl))return result}return"about:"===url.substr(0,6)||"moz-"===url.substr(0,4)?result:(domain=OmegaPac.getBaseDomain(Url.parse(url).hostname),{url:url,domain:domain,tempRuleProfileName:_this.queryTempRule(domain),errorCount:errorCount})}))},ChromeOptions}(OmegaTarget.Options),module.exports=ChromeOptions},{"./chrome_port":10,"./fetch_url":12,"./web_request_monitor":26,"omega-target":8,querystring:6,url:7}],16:[function(require,module,exports){var ListenerProxyImpl,ScriptProxyImpl,SettingsProxyImpl;ListenerProxyImpl=require("./proxy_impl_listener"),SettingsProxyImpl=require("./proxy_impl_settings"),ScriptProxyImpl=require("./proxy_impl_script"),exports.proxyImpls=[ListenerProxyImpl,ScriptProxyImpl,SettingsProxyImpl],exports.getProxyImpl=function(log){var Impl,i,len,ref;for(i=0,len=(ref=exports.proxyImpls).length;i<len;i++)if((Impl=ref[i]).isSupported())return new Impl(log);throw new Error("Your browser does not support proxy settings!")}},{"./proxy_impl_listener":19,"./proxy_impl_script":20,"./proxy_impl_settings":21}],17:[function(require,module,exports){var OmegaPac,OmegaTarget;OmegaTarget=require("omega-target"),OmegaPac=OmegaTarget.OmegaPac,OmegaTarget.Promise,module.exports=function(){function ProxyAuth(log){this._requests={},this.log=log}return ProxyAuth.prototype.listening=!1,ProxyAuth.prototype.listen=function(){if(!this.listening)if(chrome.webRequest){if(chrome.webRequest.onAuthRequired)return chrome.webRequest.onAuthRequired.addListener(this.authHandler.bind(this),{urls:["<all_urls>"]},["blocking"]),chrome.webRequest.onCompleted.addListener(this._requestDone.bind(this),{urls:["<all_urls>"]}),chrome.webRequest.onErrorOccurred.addListener(this._requestDone.bind(this),{urls:["<all_urls>"]}),this.listening=!0;this.log.error("Proxy auth disabled! onAuthRequired not available.")}else this.log.error("Proxy auth disabled! No webRequest permission.")},ProxyAuth.prototype._keyForProxy=function(proxy){return proxy.host.toLowerCase()+":"+proxy.port},ProxyAuth.prototype.setProxies=function(profiles){var auth,fallback,i,j,key,len,len1,list,profile,proxy,ref,ref1,ref2,results,scheme;for(this._proxies={},this._fallbacks=[],results=[],i=0,len=profiles.length;i<len;i++)if((profile=profiles[i]).auth){for(j=0,len1=(ref=OmegaPac.Profiles.schemes).length;j<len1;j++)profile[(scheme=ref[j]).prop]&&(auth=null!=(ref1=profile.auth)?ref1[scheme.prop]:void 0)&&(proxy=profile[scheme.prop],key=this._keyForProxy(proxy),null==(list=this._proxies[key])&&(this._proxies[key]=list=[]),list.push({config:proxy,auth:auth,name:profile.name+"."+scheme.prop}));null!=(fallback=null!=(ref2=profile.auth)?ref2.all:void 0)?results.push(this._fallbacks.push({auth:fallback,name:profile.name+".all"})):results.push(void 0)}return results},ProxyAuth.prototype._proxies={},ProxyAuth.prototype._fallbacks=[],ProxyAuth.prototype._requests=null,ProxyAuth.prototype.authHandler=function(details){var key,list,listLen,proxy,req;return details.isProxy?(null==(req=this._requests[details.requestId])&&(this._requests[details.requestId]=req={authTries:0}),key=this._keyForProxy({host:details.challenger.host,port:details.challenger.port}),listLen=null!=(list=this._proxies[key])?list.length:0,proxy=req.authTries<listLen?list[req.authTries]:this._fallbacks[req.authTries-listLen],this.log.log("ProxyAuth",key,req.authTries,null!=proxy?proxy.name:void 0),null==proxy?{}:(req.authTries++,{authCredentials:proxy.auth})):{}},ProxyAuth.prototype._requestDone=function(details){return delete this._requests[details.requestId]},ProxyAuth}()},{"omega-target":8}],18:[function(require,module,exports){var OmegaTarget,Promise,ProxyAuth,ProxyImpl,hasProp={}.hasOwnProperty;OmegaTarget=require("omega-target"),Promise=OmegaTarget.Promise,ProxyAuth=require("./proxy_auth"),ProxyImpl=function(){function ProxyImpl(log){this.log=log}return ProxyImpl.isSupported=function(){return!1},ProxyImpl.prototype.applyProfile=function(profile,meta){return Promise.reject()},ProxyImpl.prototype.watchProxyChange=function(callback){return null},ProxyImpl.prototype.parseExternalProfile=function(details,options){return null},ProxyImpl.prototype._profileNotFound=function(name){return this.log.error("Profile "+name+" not found! Things may go very, very wrong."),OmegaPac.Profiles.create({name:name,profileType:"VirtualProfile",defaultProfileName:"direct"})},ProxyImpl.prototype.setProxyAuth=function(profile,options){return Promise.try((_this=this,function(){var _,name,ref_set,referenced_profiles;for(_ in null==_this._proxyAuth&&(_this._proxyAuth=new ProxyAuth(_this.log)),_this._proxyAuth.listen(),referenced_profiles=[],ref_set=OmegaPac.Profiles.allReferenceSet(profile,options,{profileNotFound:_this._profileNotFound.bind(_this)}))hasProp.call(ref_set,_)&&(name=ref_set[_],(profile=OmegaPac.Profiles.byName(name,options))&&referenced_profiles.push(profile));return _this._proxyAuth.setProxies(referenced_profiles)}));var _this},ProxyImpl.prototype.getProfilePacScript=function(profile,meta,options){var ast,script;return null==meta&&(meta=profile),ast=OmegaPac.PacGenerator.script(options,profile,{profileNotFound:this._profileNotFound.bind(this)}),ast=OmegaPac.PacGenerator.compress(ast),script=OmegaPac.PacGenerator.ascii(ast.print_to_string()),"/*OmegaProfile*"+OmegaPac.PacGenerator.ascii(JSON.stringify(meta.name)).replace(/\*/g,"\\u002a").replace(/\\/g,"\\u002f")+"*"+meta.revision+"*/"+script},ProxyImpl}(),module.exports=ProxyImpl},{"./proxy_auth":17,"omega-target":8}],19:[function(require,module,exports){var ListenerProxyImpl,NativePromise,extend=function(child,parent){for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);function ctor(){this.constructor=child}return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;require("omega-target"),NativePromise="undefined"!=typeof Promise&&null!==Promise?Promise:null,ListenerProxyImpl=function(superClass){function ListenerProxyImpl(){var _this;ListenerProxyImpl.__super__.constructor.apply(this,arguments),this._optionsReady=new NativePromise((_this=this,function(resolve){return _this._optionsReadyCallback=resolve})),this._initRequestListeners()}return extend(ListenerProxyImpl,superClass),ListenerProxyImpl.isSupported=function(){var ref;return"undefined"!=typeof Promise&&null!==Promise&&null!=("undefined"!=typeof browser&&null!==browser&&null!=(ref=browser.proxy)?ref.onRequest:void 0)},ListenerProxyImpl.prototype.features=["fullUrl","socks5Auth"],ListenerProxyImpl.prototype._initRequestListeners=function(){return browser.proxy.onRequest.addListener(this.onRequest.bind(this),{urls:["<all_urls>"]}),browser.proxy.onError.addListener(this.onError.bind(this))},ListenerProxyImpl.prototype.watchProxyChange=function(callback){return null},ListenerProxyImpl.prototype.applyProfile=function(profile,state,options){return this._options=options,this._profile=profile,"function"==typeof this._optionsReadyCallback&&this._optionsReadyCallback(),this._optionsReadyCallback=null,this.setProxyAuth(profile,options)},ListenerProxyImpl.prototype.onRequest=function(requestDetails){return NativePromise.resolve(this._optionsReady.then((_this=this,function(){var auth,next,profile,proxy,request,result;for(request=OmegaPac.Conditions.requestFromUrl(requestDetails.url),profile=_this._profile;profile;){if(!(result=OmegaPac.Profiles.match(profile,request)))switch(profile.profileType){case"DirectProfile":return{type:"direct"};case"SystemProfile":return;default:throw new Error("Unsupported profile: "+profile.profileType)}if(Array.isArray(result)){if(proxy=result[2],auth=result[3],proxy)return _this.proxyInfo(proxy,auth);next=result[0]}else{if(!result.profileName)break;next=OmegaPac.Profiles.nameAsKey(result.profileName)}profile=OmegaPac.Profiles.byKey(next,_this._options)}throw new Error("Profile not found: "+next)})));var _this},ListenerProxyImpl.prototype.onError=function(error){return this.log.error(error)},ListenerProxyImpl.prototype.proxyInfo=function(proxy,auth){var proxyInfo;return"socks5"===(proxyInfo={type:proxy.scheme,host:proxy.host,port:proxy.port}).type&&(proxyInfo.type="socks",auth&&(proxyInfo.username=auth.username,proxyInfo.password=auth.password)),"socks"===proxyInfo.type&&(proxyInfo.proxyDNS=!0),[proxyInfo]},ListenerProxyImpl}(require("./proxy_impl")),module.exports=ListenerProxyImpl},{"./proxy_impl":18,"omega-target":8}],20:[function(require,module,exports){var OmegaTarget,Promise,ScriptProxyImpl,extend=function(child,parent){for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);function ctor(){this.constructor=child}return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;OmegaTarget=require("omega-target"),Promise=OmegaTarget.Promise,ScriptProxyImpl=function(superClass){function ScriptProxyImpl(){return ScriptProxyImpl.__super__.constructor.apply(this,arguments)}return extend(ScriptProxyImpl,superClass),ScriptProxyImpl.isSupported=function(){var ref,ref1;return null!=("undefined"!=typeof browser&&null!==browser&&null!=(ref=browser.proxy)?ref.register:void 0)||null!=("undefined"!=typeof browser&&null!==browser&&null!=(ref1=browser.proxy)?ref1.registerProxyScript:void 0)},ScriptProxyImpl.prototype.features=["socks5Auth"],ScriptProxyImpl.prototype._proxyScriptUrl="js/omega_webext_proxy_script.min.js",ScriptProxyImpl.prototype._proxyScriptDisabled=!1,ScriptProxyImpl.prototype._proxyScriptInitialized=!1,ScriptProxyImpl.prototype._proxyScriptState={},ScriptProxyImpl.prototype.watchProxyChange=function(callback){return null},ScriptProxyImpl.prototype.applyProfile=function(profile,state,options){var _this;return this.log.error("Your browser is outdated! Full-URL based matching, etc. unsupported! Please update your browser ASAP!"),state=null!=state?state:{},this._options=options,state.currentProfileName=profile.name,""===profile.name&&(state.tempProfile=profile),"SystemProfile"===profile.profileType?(null!=browser.proxy.unregister?browser.proxy.unregister():browser.proxy.registerProxyScript("js/omega_invalid_proxy_script.js"),this._proxyScriptDisabled=!0):(this._proxyScriptState=state,Promise.all([browser.runtime.getBrowserInfo(),this._initWebextProxyScript()]).then((_this=this,function(arg){var info;return"Mozilla"===(info=arg[0]).vendor&&info.buildID<"20170918220054"&&(_this.log.error("Your browser is outdated! SOCKS5 DNS/Auth unsupported! Please update your browser ASAP! (Current Build "+info.buildID+")"),_this._proxyScriptState.useLegacyStringReturn=!0),_this._proxyScriptStateChanged()}))),this.setProxyAuth(profile,options)},ScriptProxyImpl.prototype._initWebextProxyScript=function(){var promise,_this;return this._proxyScriptInitialized||(browser.proxy.onProxyError.addListener((_this=this,function(err){if(null!=(null!=err?err.message:void 0)){if(err.message.indexOf("Invalid Proxy Rule: DIRECT")>=0)return;if(err.message.indexOf("Return type must be a string")>=0)return _this.log.error("Your browser is outdated! SOCKS5 DNS/Auth unsupported! Please update your browser ASAP!"),_this._proxyScriptState.useLegacyStringReturn=!0,void _this._proxyScriptStateChanged()}return _this.log.error(err)})),browser.runtime.onMessage.addListener(function(_this){return function(message){if("proxyScriptLog"===message.event)return"error"===message.level||"warn"===message.level?_this.log.error(message):_this.log.log(message)}}(this))),!this._proxyScriptInitialized||this._proxyScriptDisabled?(promise=new Promise((function(resolve){var onMessage;return onMessage=function(message){"proxyScriptLoaded"===message.event&&(resolve(),browser.runtime.onMessage.removeListener(onMessage))},browser.runtime.onMessage.addListener(onMessage)})),null!=browser.proxy.register?browser.proxy.register(this._proxyScriptUrl):browser.proxy.registerProxyScript(this._proxyScriptUrl),this._proxyScriptDisabled=!1):promise=Promise.resolve(),this._proxyScriptInitialized=!0,promise},ScriptProxyImpl.prototype._proxyScriptStateChanged=function(){return browser.runtime.sendMessage({event:"proxyScriptStateChanged",state:this._proxyScriptState,options:this._options},{toProxyScript:!0})},ScriptProxyImpl}(require("./proxy_impl")),module.exports=ScriptProxyImpl},{"./proxy_impl":18,"omega-target":8}],21:[function(require,module,exports){var OmegaPac,OmegaTarget,SettingsProxyImpl,chromeApiPromisify,extend=function(child,parent){for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);function ctor(){this.constructor=child}return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;OmegaTarget=require("omega-target"),OmegaPac=OmegaTarget.OmegaPac,OmegaTarget.Promise,chromeApiPromisify=require("../chrome_api").chromeApiPromisify,SettingsProxyImpl=function(superClass){function SettingsProxyImpl(){return SettingsProxyImpl.__super__.constructor.apply(this,arguments)}return extend(SettingsProxyImpl,superClass),SettingsProxyImpl.isSupported=function(){var ref;return null!=("undefined"!=typeof chrome&&null!==chrome&&null!=(ref=chrome.proxy)?ref.settings:void 0)},SettingsProxyImpl.prototype.features=["fullUrlHttp","pacScript","watchProxyChange"],SettingsProxyImpl.prototype.applyProfile=function(profile,meta,options){var config,_this;return null==meta&&(meta=profile),"SystemProfile"===profile.profileType?chromeApiPromisify(chrome.proxy.settings,"clear")({}).then((_this=this,function(){chrome.proxy.settings.get({},_this._proxyChangeListener)})):(config={},"DirectProfile"===profile.profileType?config.mode="direct":"PacProfile"===profile.profileType?(config.mode="pac_script",config.pacScript=!profile.pacScript||OmegaPac.Profiles.isFileUrl(profile.pacUrl)?{url:profile.pacUrl,mandatory:!0}:{data:OmegaPac.PacGenerator.ascii(profile.pacScript),mandatory:!0}):"FixedProfile"===profile.profileType?config=this._fixedProfileConfig(profile):(config.mode="pac_script",config.pacScript={mandatory:!0,data:this.getProfilePacScript(profile,meta,options)}),this.setProxyAuth(profile,options).then((function(){return chromeApiPromisify(chrome.proxy.settings,"set")({value:config})})).then(function(_this){return function(){chrome.proxy.settings.get({},_this._proxyChangeListener)}}(this)))},SettingsProxyImpl.prototype._fixedProfileConfig=function(profile){var bypassList,condition,config,j,k,l,len,len1,len2,protocol,protocolProxySet,protocols,ref,rules;for((config={}).mode="fixed_servers",rules={},protocolProxySet=!1,j=0,len=(protocols=["proxyForHttp","proxyForHttps","proxyForFtp"]).length;j<len;j++)null!=profile[protocol=protocols[j]]&&(rules[protocol]=profile[protocol],protocolProxySet=!0);if(profile.fallbackProxy)if("http"===profile.fallbackProxy.scheme)if(protocolProxySet)for(k=0,len1=protocols.length;k<len1;k++)null==rules[protocol=protocols[k]]&&(rules[protocol]=JSON.parse(JSON.stringify(profile.fallbackProxy)));else rules.singleProxy=profile.fallbackProxy;else rules.fallbackProxy=profile.fallbackProxy;else protocolProxySet||(config.mode="direct");if("direct"!==config.mode){for(rules.bypassList=bypassList=[],l=0,len2=(ref=profile.bypassList).length;l<len2;l++)condition=ref[l],bypassList.push(this._formatBypassItem(condition));config.rules=rules}return config},SettingsProxyImpl.prototype._formatBypassItem=function(condition){var i,str;return i=(str=OmegaPac.Conditions.str(condition)).indexOf(" "),str.substr(i+1)},SettingsProxyImpl.prototype._proxyChangeWatchers=null,SettingsProxyImpl.prototype._proxyChangeListener=function(details){var j,len,ref,ref1,results,watcher;for(results=[],j=0,len=(ref1=null!=(ref=this._proxyChangeWatchers)?ref:[]).length;j<len;j++)watcher=ref1[j],results.push(watcher(details));return results},SettingsProxyImpl.prototype.watchProxyChange=function(callback){var ref,ref1;null==this._proxyChangeWatchers&&(this._proxyChangeWatchers=[],null!=("undefined"!=typeof chrome&&null!==chrome&&null!=(ref=chrome.proxy)&&null!=(ref1=ref.settings)?ref1.onChange:void 0)&&chrome.proxy.settings.onChange.addListener(this._proxyChangeListener.bind(this))),this._proxyChangeWatchers.push(callback)},SettingsProxyImpl.prototype.parseExternalProfile=function(details,options){var bypassCount,bypassSet,host,j,k,l,len,len1,len2,len3,m,pattern,profile,prop,props,proxies,ref,ref1,result,url,_this;if(details.name)return details;switch(details.value.mode){case"system":return OmegaPac.Profiles.byName("system");case"direct":return OmegaPac.Profiles.byName("direct");case"auto_detect":return OmegaPac.Profiles.create({profileType:"PacProfile",name:"",pacUrl:"http://wpad/wpad.dat"});case"pac_script":return(url=details.value.pacScript.url)?(profile=null,OmegaPac.Profiles.each(options,(function(key,p){if("PacProfile"===p.profileType&&p.pacUrl===url)return profile=p})),null!=profile?profile:OmegaPac.Profiles.create({profileType:"PacProfile",name:"",pacUrl:url})):function(){var end,magic,profileName,revision,script,tokens;if(profile=null,script=details.value.pacScript.data,OmegaPac.Profiles.each(options,(function(key,p){if("PacProfile"===p.profileType&&p.pacScript===script)return profile=p})),profile)return profile;if(magic="/*OmegaProfile*",(script=script.trim()).substr(0,magic.length)===magic&&(end=script.indexOf("*/"))>0){magic.length,profileName=(tokens=script.substring(magic.length,end).split("*"))[0],revision=tokens[1];try{profileName=JSON.parse(profileName)}catch(error){error,profileName=null}if(profileName&&revision&&(profile=OmegaPac.Profiles.byName(profileName,options),0===OmegaPac.Revision.compare(profile.revision,revision)))return profile}return OmegaPac.Profiles.create({profileType:"PacProfile",name:"",pacScript:script})}();case"fixed_servers":for(proxies={},j=0,len=(props=["proxyForHttp","proxyForHttps","proxyForFtp","fallbackProxy","singleProxy"]).length;j<len;j++)prop=props[j],result=OmegaPac.Profiles.pacResult(details.value.rules[prop]),"singleProxy"===prop&&null!=details.value.rules[prop]?proxies.fallbackProxy=result:proxies[prop]=result;if(bypassSet={},bypassCount=0,details.value.rules.bypassList)for(k=0,len1=(ref=details.value.rules.bypassList).length;k<len1;k++)pattern=ref[k],bypassSet[pattern]=!0,bypassCount++;if(bypassSet["<local>"])for(l=0,len2=(ref1=OmegaPac.Conditions.localHosts).length;l<len2;l++)host=ref1[l],bypassSet[host]&&(delete bypassSet[host],bypassCount--);if(profile=null,OmegaPac.Profiles.each(options,(_this=this,function(key,p){var condition,len3,len4,m,n,ref2,rules;if("FixedProfile"===p.profileType&&p.bypassList.length===bypassCount){for(m=0,len3=(ref2=p.bypassList).length;m<len3;m++)if(condition=ref2[m],!bypassSet[condition.pattern])return;if((rules=_this._fixedProfileConfig(p).rules).singleProxy&&(rules.fallbackProxy=rules.singleProxy,delete rules.singleProxy),null!=rules){for(n=0,len4=props.length;n<len4;n++)if((rules[prop=props[n]]||proxies[prop])&&OmegaPac.Profiles.pacResult(rules[prop])!==proxies[prop])return;return profile=p}}})),profile)return profile;for(profile=OmegaPac.Profiles.create({profileType:"FixedProfile",name:""}),m=0,len3=props.length;m<len3;m++)prop=props[m],details.value.rules[prop]&&("singleProxy"===prop?profile.fallbackProxy=details.value.rules[prop]:profile[prop]=details.value.rules[prop]);return profile.bypassList=function(){var results;for(pattern in results=[],bypassSet)hasProp.call(bypassSet,pattern)&&results.push({conditionType:"BypassCondition",pattern:pattern});return results}(),profile}},SettingsProxyImpl}(require("./proxy_impl")),module.exports=SettingsProxyImpl},{"../chrome_api":9,"./proxy_impl":18,"omega-target":8}],22:[function(require,module,exports){var ChromeStorage,OmegaTarget,Promise,chromeApiPromisify,extend=function(child,parent){for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);function ctor(){this.constructor=child}return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;chromeApiPromisify=require("./chrome_api").chromeApiPromisify,OmegaTarget=require("omega-target"),Promise=OmegaTarget.Promise,ChromeStorage=function(superClass){function ChromeStorage(areaName1){var ref;this.areaName=areaName1,("undefined"!=typeof browser&&null!==browser&&null!=(ref=browser.storage)?ref[this.areaName]:void 0)?this.storage=browser.storage[this.areaName]:this.storage={get:chromeApiPromisify(chrome.storage[this.areaName],"get"),set:chromeApiPromisify(chrome.storage[this.areaName],"set"),remove:chromeApiPromisify(chrome.storage[this.areaName],"remove"),clear:chromeApiPromisify(chrome.storage[this.areaName],"clear")}}return extend(ChromeStorage,superClass),ChromeStorage.parseStorageErrors=function(err){var sustainedPerMinute;return(null!=err?err.message:void 0)&&(sustainedPerMinute="MAX_SUSTAINED_WRITE_OPERATIONS_PER_MINUTE",err.message.indexOf("QUOTA_BYTES_PER_ITEM")>=0?(err=new OmegaTarget.Storage.QuotaExceededError).perItem=!0:err.message.indexOf("QUOTA_BYTES")>=0?err=new OmegaTarget.Storage.QuotaExceededError:err.message.indexOf("MAX_ITEMS")>=0?(err=new OmegaTarget.Storage.QuotaExceededError).maxItems=!0:err.message.indexOf("MAX_WRITE_OPERATIONS_")>=0?(err=new OmegaTarget.Storage.RateLimitExceededError).message.indexOf("MAX_WRITE_OPERATIONS_PER_HOUR")>=0?err.perHour=!0:err.message.indexOf("MAX_WRITE_OPERATIONS_PER_MINUTE")>=0&&(err.perMinute=!0):err.message.indexOf(sustainedPerMinute)>=0?((err=new OmegaTarget.Storage.RateLimitExceededError).perMinute=!0,err.sustained=10):(err.message.indexOf("is not available")>=0||err.message.indexOf("Please set webextensions.storage.sync.enabled to true")>=0)&&(err=new OmegaTarget.Storage.StorageUnavailableError)),Promise.reject(err)},ChromeStorage.prototype.get=function(keys){return null==keys&&(keys=null),Promise.resolve(this.storage.get(keys)).catch(ChromeStorage.parseStorageErrors)},ChromeStorage.prototype.set=function(items){return 0===Object.keys(items).length?Promise.resolve({}):Promise.resolve(this.storage.set(items)).catch(ChromeStorage.parseStorageErrors)},ChromeStorage.prototype.remove=function(keys){return null==keys?Promise.resolve(this.storage.clear()):Array.isArray(keys)&&0===keys.length?Promise.resolve({}):Promise.resolve(this.storage.remove(keys)).catch(ChromeStorage.parseStorageErrors)},ChromeStorage.prototype.watch=function(keys,callback){var area,base,i,id,keyMap,len,name;for(null==(base=ChromeStorage.watchers)[name=this.areaName]&&(base[name]={}),area=ChromeStorage.watchers[this.areaName],{keys:keys,callback:callback},id=Date.now().toString();area[id];)id=Date.now().toString();if(Array.isArray(keys)){for(keyMap={},i=0,len=keys.length;i<len;i++)keyMap[keys[i]]=!0;keys=keyMap}return area[id]={keys:keys,callback:callback},ChromeStorage.onChangedListenerInstalled||(chrome.storage.onChanged.addListener(ChromeStorage.onChangedListener),ChromeStorage.onChangedListenerInstalled=!0),function(){return delete area[id]}},ChromeStorage.onChangedListener=function(changes,areaName){var _,change,key,map,match,ref,results,watcher;for(_ in map=null,results=[],ref=ChromeStorage.watchers[areaName]){if(!(match=null===(watcher=ref[_]).keys))for(key in changes)if(hasProp.call(changes,key)&&watcher.keys[key]){match=!0;break}if(match){if(null==map)for(key in map={},changes)hasProp.call(changes,key)&&(change=changes[key],map[key]=change.newValue);results.push(watcher.callback(map))}else results.push(void 0)}return results},ChromeStorage.onChangedListenerInstalled=!1,ChromeStorage.watchers={},ChromeStorage}(OmegaTarget.Storage),module.exports=ChromeStorage},{"./chrome_api":9,"omega-target":8}],23:[function(require,module,exports){var ChromePort,OmegaTarget,Promise;(OmegaTarget=require("omega-target")).OmegaPac,Promise=OmegaTarget.Promise,ChromePort=require("./chrome_port"),module.exports=function(){function SwitchySharp(){}return SwitchySharp.extId="dpplabbmogkhghncfbfdeeokoefdjegm",SwitchySharp.prototype.port=null,SwitchySharp.prototype.monitor=function(action){if("moz-"!==location.href.substr(0,4))return"undefined"!=typeof port&&null!==port||null!=this._monitorTimerId||(this._monitorTimerId=setInterval(this._connect.bind(this),5e3),"reconnect"===action)?void 0:this._connect()},SwitchySharp.prototype.getOptions=function(){var _this;return this._getOptions||(this._getOptions=new Promise((_this=this,function(resolve){return _this._getOptionsResolver=resolve,_this.monitor()}))),this._getOptions},SwitchySharp.prototype._getOptions=null,SwitchySharp.prototype._getOptionsResolver=null,SwitchySharp.prototype._monitorTimerId=null,SwitchySharp.prototype._onMessage=function(msg){switch(this._monitorTimerId&&(clearInterval(this._monitorTimerId),this._monitorTimerId=null),null!=msg?msg.action:void 0){case"state":if(OmegaTarget.Log.log(msg),this._getOptionsResolver)return this.port.postMessage({action:"getOptions"});break;case"options":return"function"==typeof this._getOptionsResolver&&this._getOptionsResolver(msg.options),this._getOptionsResolver=null}},SwitchySharp.prototype._onDisconnect=function(msg){return this.port=null,this._getOptions=null,this._getOptionsResolver=null,this.monitor("reconnect")},SwitchySharp.prototype._connect=function(){var ref;this.port||(this.port=new ChromePort(chrome.runtime.connect(SwitchySharp.extId)),this.port.onDisconnect.addListener(this._onDisconnect.bind(this)),null!=(ref=this.port)&&ref.onMessage.addListener(this._onMessage.bind(this)));try{this.port.postMessage({action:"disable"})}catch(error){error,this.port=null}return null!=this.port},SwitchySharp}()},{"./chrome_port":10,"omega-target":8}],24:[function(require,module,exports){var ChromeSyncStorage,OmegaTarget,Promise,_processPush,getAll,getGist,getLastCommit,gistHost,gistId,gistToken,isPulling,isPushing,mainLetters,onChangedListenerInstalled,optionFilename,optionsSync,processCheckCommit,processPull,processPush,state,updateGist,hasProp={}.hasOwnProperty,extend=function(child,parent){for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);function ctor(){this.constructor=child}return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};OmegaTarget=require("omega-target"),Promise=OmegaTarget.Promise,onChangedListenerInstalled=!1,isPulling=!1,isPushing=!1,state=null,optionsSync=null,optionFilename=(mainLetters=["Z","e","r","o","O","m","e","g","a"]).concat([".json"]).join(""),gistId="",gistToken="",gistHost="https://api.github.com",processCheckCommit=function(){return getLastCommit(gistId).then((function(remoteCommit){return state.set({lastGistSync:Date.now()}).then((function(){return state.get({lastGistCommit:"-2"}).then((function(arg){return arg.lastGistCommit!==remoteCommit}))}))})).catch((function(){return!0}))},processPull=function(syncStore){return new Promise((function(resolve,reject){return getGist(gistId).then((function(gist){var changes;return isPushing?resolve({changes:{}}):(changes={},getAll(syncStore).then((function(data){var key,options,optionsStr,ref,ref1,target,val;try{for(key in optionsStr=null!=(ref=gist.files[optionFilename])?ref.content:void 0,options=JSON.parse(optionsStr),data)hasProp.call(data,key)&&(val=data[key],changes[key]={oldValue:val});for(key in options)hasProp.call(options,key)&&(val=options[key],(target=changes[key])||(changes[key]={},target=changes[key]),target.newValue=val);for(key in changes)hasProp.call(changes,key)&&(val=changes[key],JSON.stringify(val.oldValue)===JSON.stringify(val.newValue)&&delete changes[key])}catch(error){error,changes={}}return null!=state&&state.set({lastGistCommit:null!=(ref1=gist.history[0])?ref1.version:void 0,lastGistState:"success",lastGistSync:Date.now()}),resolve({changes:changes,remoteOptions:options})})))})).catch((function(e){return null!=state&&state.set({lastGistSync:Date.now(),lastGistState:"fail: "+e}),resolve({changes:{}})}))}))},getAll=function(syncStore){return idbKeyval.entries(syncStore).then((function(entries){var data;return data={},entries.forEach((function(entry){return data[entry[0]]=entry[1]})),data}))},_processPush=function(){var syncStore;return processPush.sequence.length>0?(syncStore=processPush.sequence[processPush.sequence.length-1],processPush.sequence.length=0,getAll(syncStore).then((function(data){return updateGist(gistId,data)})).then((function(){return _processPush()}))):isPushing=!1},(processPush=function(syncStore){if(processPush.sequence.push(syncStore),!isPushing)return isPushing=!0,setTimeout(_processPush,600)}).sequence=[],getLastCommit=function(gistId){return fetch(gistHost+"/gists/"+gistId+"/commits?per_page=1",{headers:{Accept:"application/vnd.github+json",Authorization:"Bearer "+gistToken,"X-GitHub-Api-Version":"2022-11-28"}}).then((function(res){return res.json()})).then((function(data){var ref;if(data.message)throw data.message;return null!=(ref=data[0])?ref.version:void 0}))},getGist=function(gistId){return fetch(gistHost+"/gists/"+gistId,{headers:{Accept:"application/vnd.github+json",Authorization:"Bearer "+gistToken,"X-GitHub-Api-Version":"2022-11-28"}}).then((function(res){return res.json()})).then((function(data){if(data.message)throw data.message;return data}))},updateGist=function(gistId,options){var postBody;return(postBody={description:mainLetters.concat([" Sync"]).join(""),files:{}}).files[optionFilename]={content:JSON.stringify(options,null,4)},fetch(gistHost+"/gists/"+gistId,{headers:{Accept:"application/vnd.github+json",Authorization:"Bearer "+gistToken,"X-GitHub-Api-Version":"2022-11-28"},method:"PATCH",body:JSON.stringify(postBody)}).then((function(res){return res.json()})).then((function(data){var lastGistCommit,ref;if(data.message)throw data.message;return lastGistCommit=null!=(ref=data.history[0])?ref.version:void 0,null!=state&&state.set({lastGistCommit:lastGistCommit,lastGistState:"success",lastGistSync:Date.now()}).then((function(){return null!=optionsSync?optionsSync.updateBuiltInSyncConfigIf({lastGistCommit:lastGistCommit}):void 0})),data})).catch((function(e){return null!=state&&state.set({lastGistState:"fail: "+e,lastGistSync:Date.now()}),console.error("update gist fail::",e)}))},ChromeSyncStorage=function(superClass){function ChromeSyncStorage(areaName1,_state){var _remove,clear,get,remove,set,syncStore;this.areaName=areaName1,state=_state,syncStore=idbKeyval.createStore("sync-store","sync"),this.syncStore=syncStore,get=function(key){return new Promise((function(resolve,reject){return getAll(syncStore).then((function(data){var result;return result={},Array.isArray(key)?key.forEach(_key((function(){return result[_key]=data[_key]}))):null===key?result=data:result[key]=data[key],resolve(result)}))}))},set=function(record){return new Promise((function(resolve,reject){var entries,key,value;try{if(!record||"object"!=typeof record||Array.isArray(record))throw new SyntaxError("Only Object with key value pairs are acceptable");for(key in entries=[],record)hasProp.call(record,key)&&(value=record[key],entries.push([key,value]));return idbKeyval.setMany(entries,syncStore).then((function(){return processPush(syncStore),resolve(record)}))}catch(error){return reject(error)}}))},_remove=function(key){return Array.isArray(key)?Promise.resolve(idbKeyval.delMany(key,syncStore)):Promise.resolve(idbKeyval.del(key,syncStore))},remove=function(key){return Promise.resolve(_remove(key).then((function(){processPush(syncStore)})))},clear=function(){return Promise.resolve(idbKeyval.clear(syncStore).then((function(){processPush(syncStore)})))},this.storage={get:get,set:set,remove:remove,clear:clear}}return extend(ChromeSyncStorage,superClass),ChromeSyncStorage.parseStorageErrors=function(err){return Promise.reject(err)},ChromeSyncStorage.prototype.get=function(keys){return null==keys&&(keys=null),Promise.resolve(this.storage.get(keys)).catch(ChromeSyncStorage.parseStorageErrors)},ChromeSyncStorage.prototype.set=function(items){return 0===Object.keys(items).length?Promise.resolve({}):Promise.resolve(this.storage.set(items)).catch(ChromeSyncStorage.parseStorageErrors)},ChromeSyncStorage.prototype.remove=function(keys){return null==keys?Promise.resolve(this.storage.clear()):Array.isArray(keys)&&0===keys.length?Promise.resolve({}):Promise.resolve(this.storage.remove(keys)).catch(ChromeSyncStorage.parseStorageErrors)},ChromeSyncStorage.prototype.destroy=function(){return idbKeyval.clear(this.syncStore)},ChromeSyncStorage.prototype.flush=function(arg){var data,entries,key,result,value,_this;if(data=arg.data,entries=[],result=null,data&&data.schemaVersion){for(key in data)hasProp.call(data,key)&&(value=data[key],entries.push([key,value]));result=idbKeyval.clear(this.syncStore).then((_this=this,function(){return idbKeyval.setMany(entries,_this.syncStore)}))}return Promise.resolve(result)},ChromeSyncStorage.prototype.init=function(args){return optionsSync=args.optionsSync,state=args.state,(gistId=args.gistId||"").indexOf("/")>=0&&(gistId=(gistId=(gistId=gistId.replace(/\/+$/,"")).split("/"))[gistId.length-1]),gistToken=args.gistToken,new Promise((function(resolve,reject){return getLastCommit(gistId).then((function(lastGistCommit){return args.withRemoteData?getGist(gistId).then((function(gist){var options,optionsStr;try{return optionsStr=gist.files[optionFilename].content,options=JSON.parse(optionsStr),resolve({options:options,lastGistCommit:lastGistCommit})}catch(error){return error,resolve({})}})):resolve({})})).catch((function(e){return reject(e)}))}))},ChromeSyncStorage.prototype.checkChange=function(opts){return null==opts&&(opts={}),isPulling=!0,processCheckCommit().then((_this=this,function(isChanged){return isChanged||opts.force?processPull(_this.syncStore).then((function(arg){var changes,remoteOptions;return changes=arg.changes,remoteOptions=arg.remoteOptions,_this.flush({data:remoteOptions}).then((function(){return isPulling=!1,ChromeSyncStorage.onChangedListener(changes,_this.areaName,opts)}))})):(console.log("no changed"),isPulling=!1)}));var _this},ChromeSyncStorage.prototype.watch=function(keys,callback){var area,base,enableSync,i,id,keyMap,len,name,_this;for(chrome.alarms.create("omega.syncCheck",{periodInMinutes:5}),null==(base=ChromeSyncStorage.watchers)[name=this.areaName]&&(base[name]={}),area=ChromeSyncStorage.watchers[this.areaName],{keys:keys,callback:callback},enableSync=!0,id=Date.now().toString();area[id];)id=Date.now().toString();if(Array.isArray(keys)){for(keyMap={},i=0,len=keys.length;i<len;i++)keyMap[keys[i]]=!0;keys=keyMap}return area[id]={keys:keys,callback:callback},onChangedListenerInstalled||(this.checkChange(),chrome.alarms.onAlarm.addListener((_this=this,function(alarm){if(enableSync&&!isPulling)return"omega.syncCheck"===alarm.name?_this.checkChange():void 0})),onChangedListenerInstalled=!0),function(){return enableSync=!1,delete area[id]}},ChromeSyncStorage.onChangedListener=function(changes,areaName,opts){var _,change,key,map,match,ref,results,watcher;for(_ in null==opts&&(opts={}),map=null,results=[],ref=ChromeSyncStorage.watchers[areaName]){if(!(match=null===(watcher=ref[_]).keys))for(key in changes)if(hasProp.call(changes,key)&&watcher.keys[key]){match=!0;break}if(match){if(null==map)for(key in map={},changes)hasProp.call(changes,key)&&(change=changes[key],map[key]=change.newValue);results.push(watcher.callback(map,opts))}else results.push(void 0)}return results},ChromeSyncStorage.watchers={},ChromeSyncStorage}(OmegaTarget.Storage),module.exports=ChromeSyncStorage},{"omega-target":8}],25:[function(require,module,exports){var ChromeTabs,hasProp={}.hasOwnProperty;ChromeTabs=function(){function ChromeTabs(actionForUrl){this.actionForUrl=actionForUrl,this._dirtyTabs={}}return ChromeTabs.prototype._defaultAction=null,ChromeTabs.prototype._badgeTab=null,ChromeTabs.prototype.ignoreError=function(){chrome.runtime.lastError},ChromeTabs.prototype.watch=function(){return chrome.tabs.onUpdated.addListener(this.onUpdated.bind(this)),chrome.tabs.onActivated.addListener((_this=this,function(info){return chrome.tabs.get(info.tabId,(function(tab){if(!chrome.runtime.lastError)return _this._dirtyTabs.hasOwnProperty(info.tabId)?_this.onUpdated(tab.id,{},tab):void 0}))}));var _this},ChromeTabs.prototype.resetAll=function(action){var _this;return this._defaultAction=action,chrome.tabs.query({},(_this=this,function(tabs){return _this._dirtyTabs={},tabs.forEach((function(tab){if(_this._dirtyTabs[tab.id]=tab.id,tab.active)return _this.onUpdated(tab.id,{},tab)}))})),null!=chrome.action.setPopup?chrome.action.setTitle({title:action.title}):chrome.action.setTitle({title:action.shortTitle}),this.setIcon(action.icon)},ChromeTabs.prototype.onUpdated=function(tabId,changeInfo,tab){if(this._dirtyTabs.hasOwnProperty(tab.id))delete this._dirtyTabs[tab.id];else if(null==changeInfo.url&&null!=changeInfo.status&&"loading"!==changeInfo.status)return;return this.processTab(tab,changeInfo)},ChromeTabs.prototype.processTab=function(tab,changeInfo){var base,id,ref,_this;if(this._badgeTab)for(id in ref=this._badgeTab)if(hasProp.call(ref,id)){try{"function"==typeof(base=chrome.action).setBadgeText&&base.setBadgeText({text:"",tabId:id})}catch(error){}this._badgeTab=null}if(null!=tab.url&&0!==tab.url.indexOf("chrome"))return this.actionForUrl(tab.url).then((_this=this,function(action){if(action)return _this.setIcon(action.icon,tab.id),null!=chrome.action.setPopup?chrome.action.setTitle({title:action.title,tabId:tab.id}):chrome.action.setTitle({title:action.shortTitle,tabId:tab.id});_this.clearIcon(tab.id)})).catch((function(e){return console.log("error:",e)}));this._defaultAction&&(chrome.action.setTitle({title:this._defaultAction.title,tabId:tab.id}),this.clearIcon(tab.id))},ChromeTabs.prototype.setTabBadge=function(tab,badge){var base,base1;return null==this._badgeTab&&(this._badgeTab={}),this._badgeTab[tab.id]=!0,"function"==typeof(base=chrome.action).setBadgeText&&base.setBadgeText({text:badge.text,tabId:tab.id}),"function"==typeof(base1=chrome.action).setBadgeBackgroundColor?base1.setBadgeBackgroundColor({color:badge.color,tabId:tab.id}):void 0},ChromeTabs.prototype.setIcon=function(icon,tabId){var params;if(null!=icon)return params=null!=tabId?{imageData:icon,tabId:tabId}:{imageData:icon},this._chromeSetIcon(params)},ChromeTabs.prototype._chromeSetIcon=function(params){var base,base1;try{return"function"==typeof(base=chrome.action).setIcon?base.setIcon(params,this.ignoreError):void 0}catch(error){return error,params.imageData={19:params.imageData[19],38:params.imageData[38]},"function"==typeof(base1=chrome.action).setIcon?base1.setIcon(params,this.ignoreError):void 0}},ChromeTabs.prototype.clearIcon=function(tabId){var ref;if(null!=(null!=(ref=this._defaultAction)?ref.icon:void 0))return this._chromeSetIcon({imageData:this._defaultAction.icon,tabId:tabId},this.ignoreError)},ChromeTabs}(),module.exports=ChromeTabs},{}],26:[function(require,module,exports){var Heap,hasProp={}.hasOwnProperty;Heap=require("heap"),require("url"),module.exports=function(){function WebRequestMonitor(getSummaryId){this.getSummaryId=getSummaryId,this._requests={},this._recentRequests=new Heap((function(a,b){return a._startTime-b._startTime})),this._callbacks=[],this._tabCallbacks=[],this.tabInfo={}}return WebRequestMonitor.prototype._callbacks=null,WebRequestMonitor.prototype.watching=!1,WebRequestMonitor.prototype.timer=null,WebRequestMonitor.prototype.watch=function(callback){if(this._callbacks.push(callback),!this.watching){if(chrome.webRequest)return chrome.webRequest.onBeforeRequest.addListener(this._requestStart.bind(this),{urls:["<all_urls>"]}),chrome.webRequest.onHeadersReceived.addListener(this._requestHeadersReceived.bind(this),{urls:["<all_urls>"]}),chrome.webRequest.onBeforeRedirect.addListener(this._requestRedirected.bind(this),{urls:["<all_urls>"]}),chrome.webRequest.onCompleted.addListener(this._requestDone.bind(this),{urls:["<all_urls>"]}),chrome.webRequest.onErrorOccurred.addListener(this._requestError.bind(this),{urls:["<all_urls>"]}),this.watching=!0;console.log("Request monitor disabled! No webRequest permission.")}},WebRequestMonitor.prototype._requests=null,WebRequestMonitor.prototype._recentRequests=null,WebRequestMonitor.prototype._requestStart=function(req){var callback,i,len,ref,results;if(!(req.tabId<0)){for(req._startTime=Date.now(),this._requests[req.requestId]=req,this._recentRequests.push(req),null==this.timer&&(this.timer=setInterval(this._tick.bind(this),1e3)),results=[],i=0,len=(ref=this._callbacks).length;i<len;i++)callback=ref[i],results.push(callback("start",req));return results}},WebRequestMonitor.prototype._tick=function(){var i,len,now,ref,req,reqInfo,results;for(now=Date.now(),results=[];req=this._recentRequests.peek();){if((reqInfo=this._requests[req.requestId])&&!reqInfo.noTimeout){if(now-req._startTime<5e3)break;for(reqInfo.timeoutCalled=!0,i=0,len=(ref=this._callbacks).length;i<len;i++)(0,ref[i])("timeout",reqInfo)}results.push(this._recentRequests.pop())}return results},WebRequestMonitor.prototype._requestHeadersReceived=function(req){var callback,i,len,ref,reqInfo,results;if((reqInfo=this._requests[req.requestId])&&(reqInfo.noTimeout=!0,reqInfo.timeoutCalled)){for(results=[],i=0,len=(ref=this._callbacks).length;i<len;i++)callback=ref[i],results.push(callback("ongoing",req));return results}},WebRequestMonitor.prototype._requestRedirected=function(req){var url;if(url=req.redirectUrl)return 0===url.indexOf("data:")||0===url.indexOf("about:")?this._requestDone(req):void 0},WebRequestMonitor.prototype._requestError=function(req){var callback,i,j,len,len1,ref,ref1,reqInfo,results;if(reqInfo=this._requests[req.requestId],delete this._requests[req.requestId],!(req.tabId<0)&&"net::ERR_INCOMPLETE_CHUNKED_ENCODING"!==req.error&&!(req.error.indexOf("BLOCKED")>=0)&&0!==req.error.indexOf("net::ERR_FILE_")&&0!==req.error.indexOf("NS_ERROR_ABORT")&&0!==req.url.indexOf("file:")&&0!==req.url.indexOf("chrome")&&0!==req.url.indexOf("about:")&&0!==req.url.indexOf("moz-")&&!(req.url.indexOf("://127.0.0.1")>0)&&reqInfo){if("net::ERR_ABORTED"!==req.error){for(results=[],j=0,len1=(ref1=this._callbacks).length;j<len1;j++)callback=ref1[j],results.push(callback("error",req));return results}if(reqInfo.timeoutCalled&&!reqInfo.noTimeout)for(i=0,len=(ref=this._callbacks).length;i<len;i++)(callback=ref[i])("timeoutAbort",req)}},WebRequestMonitor.prototype._requestDone=function(req){var i,len,ref;for(i=0,len=(ref=this._callbacks).length;i<len;i++)(0,ref[i])("done",req);return delete this._requests[req.requestId]},WebRequestMonitor.prototype.eventCategory={start:"ongoing",ongoing:"ongoing",timeout:"error",error:"error",timeoutAbort:"error",done:"done"},WebRequestMonitor.prototype.tabsWatching=!1,WebRequestMonitor.prototype._tabCallbacks=null,WebRequestMonitor.prototype.watchTabs=function(callback){var ref,_this;if(this._tabCallbacks.push(callback),!this.tabsWatching)return this.watch(this.setTabRequestInfo.bind(this)),this.tabsWatching=!0,chrome.tabs.onCreated.addListener((_this=this,function(tab){if(tab.id)return _this.tabInfo[tab.id]=_this._newTabInfo()})),chrome.tabs.onRemoved.addListener(function(_this){return function(tabId){return delete _this.tabInfo[tabId]}}(this)),null!=(ref=chrome.tabs.onReplaced)&&ref.addListener(function(_this){return function(added,removed){var base;return null==(base=_this.tabInfo)[added]&&(base[added]=_this._newTabInfo()),delete _this.tabInfo[removed]}}(this)),chrome.tabs.onUpdated.addListener(function(_this){return function(tabId,changeInfo,tab){var base,i,info,len,name,ref1,results;if(info=null!=(base=_this.tabInfo)[name=tab.id]?base[name]:base[name]=_this._newTabInfo()){for(results=[],i=0,len=(ref1=_this._tabCallbacks).length;i<len;i++)callback=ref1[i],results.push(callback(tab.id,info,null,"updated"));return results}}}(this)),chrome.tabs.query({},function(_this){return function(tabs){var base,i,len,name,results,tab;for(results=[],i=0,len=tabs.length;i<len;i++)tab=tabs[i],results.push(null!=(base=_this.tabInfo)[name=tab.id]?base[name]:base[name]=_this._newTabInfo());return results}}(this))},WebRequestMonitor.prototype._newTabInfo=function(){return{requests:{},requestCount:0,requestStatus:{},ongoingCount:0,errorCount:0,doneCount:0,summary:{}}},WebRequestMonitor.prototype.setTabRequestInfo=function(status,req){var callback,i,id,info,key,len,oldStatus,ref,ref1,results,summaryItem,value;if(info=this.tabInfo[req.tabId]){if("start"===status&&"main_frame"===req.type&&0!==req.url.indexOf("chrome://errorpage/"))for(key in ref=this._newTabInfo())hasProp.call(ref,key)&&(value=ref[key],info[key]=value);if(info.requestCount>1e3)return;if(info.requests[req.requestId]=req,oldStatus=info.requestStatus[req.requestId])info[this.eventCategory[oldStatus]+"Count"]--;else{if("timeoutAbort"===status)return;info.requestCount++}for(info.requestStatus[req.requestId]=status,info[this.eventCategory[status]+"Count"]++,null!=(id="function"==typeof this.getSummaryId?this.getSummaryId(req):void 0)&&("error"===this.eventCategory[status]?"error"!==this.eventCategory[oldStatus]&&(null==(summaryItem=info.summary[id])&&(summaryItem=info.summary[id]={errorCount:0}),summaryItem.errorCount++):"error"===this.eventCategory[oldStatus]&&null!=(summaryItem=info.summary[id])&&summaryItem.errorCount--),results=[],i=0,len=(ref1=this._tabCallbacks).length;i<len;i++)callback=ref1[i],results.push(callback(req.tabId,info,req,status));return results}},WebRequestMonitor}()},{heap:1,url:7}],OmegaTargetChromium:[function(require,module,exports){module.exports=require("./src/module")},{"./src/module":13}]},{},["OmegaTargetChromium"])("OmegaTargetChromium")}));