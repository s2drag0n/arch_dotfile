function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function promisifyRequest(request){return new Promise((function(resolve,reject){request.oncomplete=request.onsuccess=function(){return resolve(request.result)},request.onabort=request.onerror=function(){return reject(request.error)}}))}function createStore(dbName,storeName){var request=indexedDB.open(dbName);request.onupgradeneeded=function(){return request.result.createObjectStore(storeName)};var dbp=promisifyRequest(request);return function(txMode,callback){return dbp.then((function(db){return callback(db.transaction(storeName,txMode).objectStore(storeName))}))}}var defaultGetStoreFunc;function defaultGetStore(){return defaultGetStoreFunc||(defaultGetStoreFunc=createStore("keyval-store","keyval")),defaultGetStoreFunc}function get(key){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGetStore())("readonly",(function(store){return promisifyRequest(store.get(key))}))}function set(key,value){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:defaultGetStore())("readwrite",(function(store){return store.put(value,key),promisifyRequest(store.transaction)}))}function setMany(entries){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGetStore())("readwrite",(function(store){return entries.forEach((function(entry){return store.put(entry[1],entry[0])})),promisifyRequest(store.transaction)}))}function getMany(keys){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGetStore())("readonly",(function(store){return Promise.all(keys.map((function(key){return promisifyRequest(store.get(key))})))}))}function update(key,updater){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:defaultGetStore())("readwrite",(function(store){return new Promise((function(resolve,reject){store.get(key).onsuccess=function(){try{store.put(updater(this.result),key),resolve(promisifyRequest(store.transaction))}catch(err){reject(err)}}}))}))}function del(key){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGetStore())("readwrite",(function(store){return store.delete(key),promisifyRequest(store.transaction)}))}function delMany(keys){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:defaultGetStore())("readwrite",(function(store){return keys.forEach((function(key){return store.delete(key)})),promisifyRequest(store.transaction)}))}function clear(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaultGetStore())("readwrite",(function(store){return store.clear(),promisifyRequest(store.transaction)}))}function eachCursor(store,callback){return store.openCursor().onsuccess=function(){this.result&&(callback(this.result),this.result.continue())},promisifyRequest(store.transaction)}function keys(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaultGetStore())("readonly",(function(store){if(store.getAllKeys)return promisifyRequest(store.getAllKeys());var items=[];return eachCursor(store,(function(cursor){return items.push(cursor.key)})).then((function(){return items}))}))}function values(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaultGetStore())("readonly",(function(store){if(store.getAll)return promisifyRequest(store.getAll());var items=[];return eachCursor(store,(function(cursor){return items.push(cursor.value)})).then((function(){return items}))}))}function entries(){var customStore=arguments.length>0&&void 0!==arguments[0]?arguments[0]:defaultGetStore();return customStore("readonly",(function(store){if(store.getAll&&store.getAllKeys)return Promise.all([promisifyRequest(store.getAllKeys()),promisifyRequest(store.getAll())]).then((function(_ref){var _ref2=_slicedToArray(_ref,2),keys=_ref2[0],values=_ref2[1];return keys.map((function(key,i){return[key,values[i]]}))}));var items=[];return customStore("readonly",(function(store){return eachCursor(store,(function(cursor){return items.push([cursor.key,cursor.value])})).then((function(){return items}))}))}))}export{clear,createStore,del,delMany,entries,get,getMany,keys,promisifyRequest,set,setMany,update,values};