var checkboxKBS=document.getElementById("enableKBS"),spaceControl=document.getElementById("spaceAlwaysControl"),checkboxDanmu=document.getElementById("turnOffDanmu"),checkboxAutoplay=document.getElementById("autoplay"),checkboxExitFullscreen=document.getElementById("exitFullscreen"),radioMode0=document.getElementById("mode0"),radioMode1=document.getElementById("mode1"),radioMode2=document.getElementById("mode2"),checkboxPreventshade=document.getElementById("preventshade"),checkboxTurnOffLight=document.getElementById("turnOffLight"),
checkboxSmartLight=document.getElementById("smartLight");function init(){chrome.storage.sync.get({keyboard:!0,spaceAlwaysControl:!0,turnOffDanmu:!0,screenMode:0,autoplay:!1,exitFullscreen:!1,preventshade:!1,turnOffLight:!1,smartLight:!1},initState);initMsg();location.href.includes("from=install")&&showInstallTip();document.body.firstElementChild.classList.remove("d-none")}
function initState(a){checkboxKBS.checked=a.keyboard;checkboxKBS.addEventListener("change",saveOptions);spaceControl.checked=a.spaceAlwaysControl;spaceControl.addEventListener("change",saveOptions);checkboxDanmu.checked=a.turnOffDanmu;checkboxDanmu.addEventListener("change",saveOptions);checkboxAutoplay.checked=a.autoplay;checkboxAutoplay.addEventListener("change",saveOptions);checkboxExitFullscreen.checked=a.exitFullscreen;checkboxExitFullscreen.addEventListener("change",saveOptions);checkboxPreventshade.checked=
a.preventshade;checkboxPreventshade.addEventListener("change",saveOptions);checkboxTurnOffLight.checked=a.turnOffLight;checkboxTurnOffLight.addEventListener("change",saveOptions);checkboxSmartLight.checked=a.smartLight;checkboxSmartLight.addEventListener("change",function(){checkboxSmartLight.checked&&(checkboxTurnOffLight.checked=!0);saveOptions()});document.getElementById("mode"+a.screenMode).checked=!0;radioMode0.addEventListener("click",saveOptions);radioMode1.addEventListener("click",saveOptions);
radioMode2.addEventListener("click",saveOptions)}function initMsg(a=document){a=a.querySelectorAll("[data-i18n]");for(const b of a)b.textContent=chrome.i18n.getMessage(b.dataset.i18n)}
function saveOptions(){const a={keyboard:checkboxKBS.checked,spaceAlwaysControl:spaceControl.checked,turnOffDanmu:checkboxDanmu.checked,autoplay:checkboxAutoplay.checked,exitFullscreen:checkboxExitFullscreen.checked,preventshade:checkboxPreventshade.checked,turnOffLight:checkboxTurnOffLight.checked,smartLight:checkboxSmartLight.checked,screenMode:parseInt(document.querySelector("input[name='mode']:checked").value)};chrome.storage.sync.set(a)}
function showInstallTip(){let a=document.importNode(document.getElementById("install-tp").content,!0);initMsg(a);a.querySelector("button").addEventListener("click",function(c){this.parentElement.remove()});let b=document.body.firstElementChild;b.insertBefore(a,b.firstElementChild)}init();
